@using Microsoft.AspNetCore.Mvc.TagHelpers
@using Microsoft.Extensions.Primitives
@model Thavyra.Oidc.Models.View.AuthorizeViewModel

@(ViewData["Title"] = $"Connect to {Model.Client.DisplayName}")

<h2 class="text-bright text-3xl font-extralight mb-7 text-center">Connect to <span class="font-bold">@Model.Client.DisplayName</span></h2>

<p class="my-1.5 text-sm text-center">A third party application wants to access your Thavyra account.</p>

<p class="my-1.5 text-center">
    Signed in as
    <span class="text-bright">@Model.Username</span>
    <a class="link ml-0.5" asp-controller="Login" asp-action="Logout" asp-route-ReturnUrl="@Model.ReturnUrl">
        Change
    </a>
</p>

<hr class="my-1.5 border-dark-700"/>

<p class="my-1.5 text-sm text-center">This will give the developer of @Model.Client.DisplayName permission to:</p>

<ul class="list-disc list-inside">
    @foreach (var scope in Model.Scopes)
    {
        <li>@scope.Description</li>
    }
</ul>

<hr class="my-1.5 border-dark-700"/>

<form method="post">
    @foreach (var parameter in Context.Request.HasFormContentType ? (IEnumerable<KeyValuePair<string, StringValues>>) Context.Request.Form : Context.Request.Query)
    {
        <input type="hidden" name="@parameter.Key" value="@parameter.Value"/>
    }

    <div class="md:flex md:justify-between">

        <button class="btn btn-primary px-1.5 text-md w-full md:w-auto"
                name="submit.Accept" type="submit" value="Yes">
            Authorize
        </button>

        <button class="block link mt-3 md:m-0 py-1.5 w-full md:w-auto text-center"
                name="submit.Cancel" type="submit" value="No">
            Cancel
        </button>

    </div>
</form>